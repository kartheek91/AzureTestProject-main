trigger:
- main

pool:
  vmImage: 'windows-latest'

steps:
- task: PowerShell@2
  displayName: Install Powershell
  inputs:
    targetType: 'inline'
    script: |
      $url = "https://github.com/PowerShell/PowerShell/releases/download/v7.1.3/powershell-7.1.3-win-x64.msi"
      $output = "powershell-7.1.3-win-x64.msi"
   
      Invoke-WebRequest -Uri $url -OutFile $output
   
      Start-Process msiexec.exe -Wait -ArgumentList "/I powershell-7.1.3-win-x64.msi /quiet /norestart"
      echo Installation Completed SUccessfully!
      
- task: AzureCLI@2
  inputs:
    azureSubscription: 'MyAzureSubscription'
    scriptType: 'pscore'
    scriptLocation: 'inlineScript'
    inlineScript: |
      az login --service-principal -u $(servicePrincipalId) -p $(servicePrincipalKey) --tenant $(tenantId)

